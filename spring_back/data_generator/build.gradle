/*
 * This file was generated by the Gradle 'init' task.
 */


plugins {
    id 'tech.itunz.java-application-conventions'
    id 'war'
}

dependencies {
    implementation 'org.springframework:spring-webmvc:6.1.6'
    implementation 'org.springframework.security:spring-security-config:6.2.4'
    implementation 'org.springframework.security:spring-security-web:6.2.4'
    implementation project(':myjni')
    implementation 'jakarta.servlet:jakarta.servlet-api:6.1.0-M2'
}

war {
    duplicatesStrategy = 'EXCLUDE'

    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }

    manifest {
        attributes 'Main-Class': 'tech.itunz.data_generator.controllers.HomeController'
    }
    // Define the main class for the application.
    archiveFileName = 'backspring.war'

    from(project(':myjni').file('build/libs/shared/libcalc.so')) {
        into 'WEB-INF/lib/shared'
    }

    // Set applicationDefaultJvmArgs
    applicationDefaultJvmArgs = ["-Djava.library.path=${project.buildDir}/lib/shared"]
}

application {
    // Define the main class for the application.
    mainClass = 'tech.itunz.data_generator.HelloJni'
    applicationDefaultJvmArgs = ["-Djava.library.path=" + project(':myjni').file('build/libs/shared/').absolutePath]
}
